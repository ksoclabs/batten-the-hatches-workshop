
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../0-setup/">
      
      
        <link rel="next" href="../2-workload-security/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.5">
    
    
      
        <title>1 Asset Inventory - Batten the Hatches! Operation - Cluster lockdown</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.558e4712.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kubernetes-version" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Batten the Hatches! Operation - Cluster lockdown" class="md-header__button md-logo" aria-label="Batten the Hatches! Operation - Cluster lockdown" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 20q-2.28 0-3.89-1.57Q1 16.85 1 14.58q0-1.95 1.17-3.48 1.18-1.53 3.08-1.95.63-2.3 2.5-3.72Q9.63 4 12 4q2.93 0 4.96 2.04Q19 8.07 19 11q1.73.2 2.86 1.5 1.14 1.28 1.14 3 0 1.88-1.31 3.19T18.5 20Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Batten the Hatches! Operation - Cluster lockdown
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1 Asset Inventory
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ksoclabs/batten-the-hatches-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ksoclabs/batten-the-hatches-workshop
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Batten the Hatches! Operation - Cluster lockdown" class="md-nav__button md-logo" aria-label="Batten the Hatches! Operation - Cluster lockdown" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 20q-2.28 0-3.89-1.57Q1 16.85 1 14.58q0-1.95 1.17-3.48 1.18-1.53 3.08-1.95.63-2.3 2.5-3.72Q9.63 4 12 4q2.93 0 4.96 2.04Q19 8.07 19 11q1.73.2 2.86 1.5 1.14 1.28 1.14 3 0 1.88-1.31 3.19T18.5 20Z"/></svg>

    </a>
    Batten the Hatches! Operation - Cluster lockdown
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ksoclabs/batten-the-hatches-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ksoclabs/batten-the-hatches-workshop
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../0-setup/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          1 Asset Inventory
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        1 Asset Inventory
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kubernetes-version" class="md-nav__link">
    Kubernetes Version
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#official-kubernetes-cve-feed" class="md-nav__link">
    Official Kubernetes CVE Feed
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloud-provider" class="md-nav__link">
    Cloud Provider
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes-networking-metadata" class="md-nav__link">
    Kubernetes Networking Metadata
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes-api-resources" class="md-nav__link">
    Kubernetes API Resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-all-container-images" class="md-nav__link">
    List all Container Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-all-kubernetes-objects" class="md-nav__link">
    List all Kubernetes Objects
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next Steps
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../2-workload-security/" class="md-nav__link">
        2 Workload Configurations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../3-rbac/" class="md-nav__link">
        3 RBAC Assessment
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../4-guardrails/" class="md-nav__link">
        4 Guardrails
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../5-wrapup/" class="md-nav__link">
        Wrap Up
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kubernetes-version" class="md-nav__link">
    Kubernetes Version
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#official-kubernetes-cve-feed" class="md-nav__link">
    Official Kubernetes CVE Feed
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloud-provider" class="md-nav__link">
    Cloud Provider
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes-networking-metadata" class="md-nav__link">
    Kubernetes Networking Metadata
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes-api-resources" class="md-nav__link">
    Kubernetes API Resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-all-container-images" class="md-nav__link">
    List all Container Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-all-kubernetes-objects" class="md-nav__link">
    List all Kubernetes Objects
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next Steps
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  



  <h1>1 Asset Inventory</h1>

<p>Firstly, we need to understand what assets we are going to auditing.</p>
<p>The following are useful assets to audit:</p>
<ol>
<li>Kubernetes Version</li>
<li>Cloud Provider (AWS, GCP, Azure, etc.)</li>
<li>Kubernetes Networking Metadata</li>
</ol>
<h2 id="kubernetes-version">Kubernetes Version<a class="headerlink" href="#kubernetes-version" title="Permanent link">&para;</a></h2>
<p>The version of Kubernetes is an important aspect of your audit. 
You should be aware of the version of Kubernetes you are running and how it is supported. 
You should have a clear understanding of the Kubernetes version lifecycle and the support policy of your Kubernetes distribution.</p>
<p>The Kubernetes project maintains a <a href="https://kubernetes.io/releases/version-skew-policy/">version skew policy</a> that defines the relationship between the Kubernetes control plane and the Kubernetes nodes. 
This policy defines the supported versions of Kubernetes and the minimum version of the control plane for each Kubernetes version. 
This policy also defines the maximum version skew between the control plane and the node components.</p>
<p>You can find the supported versions of Kubernetes in the release notes for each release. 
For example, the Kubernetes release notes for version 1.25.0 can be found <a href="https://kubernetes.io/releases/#release-v1-25">here</a>.</p>
<p>The version of Kubernetes you are running can be found by running the following command:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>kubectl<span class="w"> </span>version
</code></pre></div>
<p>The output of the command should be similar to the following:</p>
<div class="highlight"><pre><span></span><code>Client<span class="w"> </span>Version:<span class="w"> </span>version.Info<span class="o">{</span>Major:<span class="s2">&quot;1&quot;</span>,<span class="w"> </span>Minor:<span class="s2">&quot;25&quot;</span>,<span class="w"> </span>GitVersion:<span class="s2">&quot;v1.25.0&quot;</span>,<span class="w"> </span>GitCommit:<span class="s2">&quot;2d3c76f9091b6bec110a5e63777c332469e0cba2&quot;</span>,<span class="w"> </span>GitTreeState:<span class="s2">&quot;clean&quot;</span>,<span class="w"> </span>BuildDate:<span class="s2">&quot;2021-09-28T14:51:23Z&quot;</span>,<span class="w"> </span>GoVersion:<span class="s2">&quot;go1.16.7&quot;</span>,<span class="w"> </span>Compiler:<span class="s2">&quot;gc&quot;</span>,<span class="w"> </span>Platform:<span class="s2">&quot;darwin/amd64&quot;</span><span class="o">}</span>
Server<span class="w"> </span>Version:<span class="w"> </span>version.Info<span class="o">{</span>Major:<span class="s2">&quot;1&quot;</span>,<span class="w"> </span>Minor:<span class="s2">&quot;25&quot;</span>,<span class="w"> </span>GitVersion:<span class="s2">&quot;v1.25.0&quot;</span>,<span class="w"> </span>GitCommit:<span class="s2">&quot;2d3c76f9091b6bec110a5e63777c332469e0cba2&quot;</span>,<span class="w"> </span>GitTreeState:<span class="s2">&quot;clean&quot;</span>,<span class="w"> </span>BuildDate:<span class="s2">&quot;2021-09-28T14:51:23Z&quot;</span>,<span class="w"> </span>GoVersion:<span class="s2">&quot;go1.16.7&quot;</span>,<span class="w"> </span>Compiler:<span class="s2">&quot;gc&quot;</span>,<span class="w"> </span>Platform:<span class="s2">&quot;linux/amd64&quot;</span><span class="o">}</span>
</code></pre></div>
<p>The output above shows that the client version is 1.25.0 and the server version is 1.25.0. 
The client version is the version of the <code>kubectl</code> binary you are running. 
The server version is the version of the Kubernetes control plane you are connected to.</p>
<p>If you are running a managed Kubernetes service, you should check the version of Kubernetes that is supported by the service. </p>
<ul>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/kubernetes-versions.html">Amazon EKS</a></li>
<li><a href="https://cloud.google.com/kubernetes-engine/docs/release-notes">Google GKE</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/aks/supported-kubernetes-versions">Azure AKS</a></li>
</ul>
<h2 id="official-kubernetes-cve-feed">Official Kubernetes CVE Feed<a class="headerlink" href="#official-kubernetes-cve-feed" title="Permanent link">&para;</a></h2>
<p>Kubernetes provides an <a href="https://kubernetes.io/docs/reference/issues-security/official-cve-feed/">official CVE</a> feed that you should subscribe to in order to ensure that your cluster versions are always up-to-date. </p>
<h2 id="cloud-provider">Cloud Provider<a class="headerlink" href="#cloud-provider" title="Permanent link">&para;</a></h2>
<p>If you are running Kubernetes on a cloud provider, you should be aware of the cloud provider you are using. 
You should also be aware of the capabilities of the cloud provider and how it impacts your Kubernetes cluster.</p>
<p>If you are running Kubernetes on AWS, you should be aware of the capabilities of EKS. 
You should also be aware of the limitations of EKS and how it impacts your Kubernetes cluster.</p>
<p>For example, if you are running Kubernetes on AWS, you should be aware of the following:</p>
<ul>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/service_limits.html">EKS Service Limits</a></li>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html">EKS Security Groups</a></li>
</ul>
<p>If you are running Kubernetes on GCP, you should be aware of the capabilities of GKE.</p>
<ul>
<li><a href="https://cloud.google.com/kubernetes-engine/quotas">GKE Service Limits</a></li>
</ul>
<p>If you are running Kubernetes on Azure, you should be aware of the capabilities of AKS.</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/aks/quotas-skus-regions">AKS Service Limits</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/aks/concepts-network#security-groups">AKS Security Groups</a></li>
</ul>
<h2 id="kubernetes-networking-metadata">Kubernetes Networking Metadata<a class="headerlink" href="#kubernetes-networking-metadata" title="Permanent link">&para;</a></h2>
<p>You should be aware of the networking metadata of the cloud provider and how it impacts your Kubernetes cluster.</p>
<p>If you are running Kubernetes on AWS, you should be aware of the following:</p>
<ul>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/network_reqs.html">EKS Networking</a></li>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/pod-networking.html">EKS VPC CNI Plugin</a></li>
</ul>
<p>If you are running Kubernetes on GCP, you should be aware of the following:</p>
<ul>
<li><a href="https://cloud.google.com/kubernetes-engine/docs/concepts/network-overview">GKE Networking</a></li>
</ul>
<p>If you are running Kubernetes on Azure, you should be aware of the following:</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/aks/concepts-network">AKS Networking</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/aks/configure-azure-cni#subnet">AKS Subnet</a></li>
</ul>
<h2 id="kubernetes-api-resources">Kubernetes API Resources<a class="headerlink" href="#kubernetes-api-resources" title="Permanent link">&para;</a></h2>
<p>The Kubernetes API 
Using <code>kubectl api-resources -o wide</code> shows all the resources, verbs and associated API-group:</p>
<p><div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>api-resources<span class="w"> </span>-o<span class="w"> </span>wide
</code></pre></div>
We get name, namespaced, kind, shortnames, and apiversion of the resources by executing the command as mentioned above.</p>
<p><em>NAME</em> – Shows the source to which the permissions are related</p>
<p><em>KIND</em> – Shows the title of the resource</p>
<p><em>SHORTNAMES</em> - A very useful code-named when interrelating with kubectl resources</p>
<p><em>APIVERSION</em> – Resembles the role required of the API groups</p>
<p><em>VERBS</em> – Displays the existing available verbs, and it is helpful when describing RBAC rules.</p>
<h2 id="list-all-container-images">List all Container Images<a class="headerlink" href="#list-all-container-images" title="Permanent link">&para;</a></h2>
<p>As you audit a Kubernetes cluster, it is important to understand exactly which container images are running inside of the environment. The following command will extract the images in your cluster for all namespaces:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>--all-namespaces<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s2">&quot;{.items[*].spec.containers[*].image}&quot;</span><span class="w"> </span><span class="p">|</span><span class="se">\</span>
tr<span class="w"> </span>-s<span class="w"> </span><span class="s1">&#39;[[:space:]]&#39;</span><span class="w"> </span><span class="s1">&#39;\n&#39;</span><span class="w"> </span><span class="p">|</span><span class="se">\</span>
sort<span class="w"> </span><span class="p">|</span><span class="se">\</span>
uniq<span class="w"> </span>-c
</code></pre></div>
<h2 id="list-all-kubernetes-objects">List all Kubernetes Objects<a class="headerlink" href="#list-all-kubernetes-objects" title="Permanent link">&para;</a></h2>
<p>To understand our attack surface and scope for the audit we need to ensure that a complete list of all running objects is obtained. The following command can quickly enumerate <code>pods</code>, <code>deployments</code>, <code>services</code>, and more:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>all<span class="w"> </span>--all-namespaces
</code></pre></div>
<p>You will notice that the output of <code>kubectl get all</code> is not comprehensive. An open-source project called <a href="https://github.com/corneliusweig/ketall">ketall</a> is installed in your shell. This will print out a much more comprehensive inventory to the screen. </p>
<div class="highlight"><pre><span></span><code>ketall
</code></pre></div>
<h2 id="next-steps">Next Steps<a class="headerlink" href="#next-steps" title="Permanent link">&para;</a></h2>
<p>Now lets begin our audit in-depth by looking at the configuration of our Kubernetes workloads <a href="../2-workload-security/">here</a>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/ksoclabs/batten-the-hatches-workshop" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.51d95adb.min.js"></script>
      
    
  </body>
</html>